<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gestión de Medicamentos</title>
</head>
<body>
    <h1>Bienvenido a la Gestión de Medicamentos</h1>

   <!-- Mostrar alertas -->
    <h2>Alertas Activas</h2>
    {% if alertas %}
        <ul>
            {% for alerta in alertas %}
                <li>
                    <strong>{{ alerta.tipo }}</strong>: {{ alerta.mensaje }}
                    {% if alerta.estado == False %}
                        <a href="{{ url_for('marcar_alerta_leida', alerta_id=alerta.id) }}">Marcar como Leída</a>
                    {% endif %}
                    <a href="{{ url_for('eliminar_alerta', alerta_id=alerta.id) }}">Eliminar</a>
                </li>
            {% endfor %}
        </ul>
    {% else %}
        <p>No hay alertas activas.</p>
    {% endif %}

    <a href="{{ url_for('index') }}">
        <button>Volver al Inicio</button>
    </a>

    <!-- Formulario para agregar un medicamento -->
    <form action="/agregar_medicamento" method="POST">
        <h2>Agregar Medicamento</h2>
        <label for="nombre">Nombre:</label>
        <input type="text" id="nombre" name="nombre" required>
        <br>
        <label for="dosis">Dosis:</label>
        <input type="text" id="dosis" name="dosis" required>
        <br>
        <label for="frecuencia">Frecuencia:</label>
        <input type="text" id="frecuencia" name="frecuencia" required>
        <br>
        <label for="fecha_vencimiento">Fecha de Vencimiento:</label>
        <input type="date" id="fecha_vencimiento" name="fecha_vencimiento" required>
        <br>
        <label for="stock">Stock:</label>
        <input type="number" id="stock" name="stock" required>
        <br>
        <button type="submit">Guardar Medicamento</button>
    </form>

    <!-- Mostrar lista de medicamentos -->
    <h2>Lista de Medicamentos</h2>
    <table>
        <thead>
            <tr>
                <th>ID</th>
                <th>Nombre</th>
                <th>Dosis</th>
                <th>Frecuencia</th>
                <th>Fecha Vencimiento</th>
                <th>Stock</th>
                <th>Acciones</th>
            </tr>
        </thead>
        <tbody>
            {% for medicamento in medicamentos %}
                <tr>
                    <td>{{ medicamento.id }}</td>
                    <td>{{ medicamento.nombre }}</td>
                    <td>{{ medicamento.dosis }}</td>
                    <td>{{ medicamento.frecuencia }}</td>
                    <td>{{ medicamento.fecha_vencimiento }}</td>
                    <td>{{ medicamento.stock }}</td>
                    <td>
                        <a href="/editar_medicamento/{{ medicamento.id }}">Editar</a>
                        <a href="/eliminar_medicamento/{{ medicamento.id }}">Eliminar</a>
                    </td>
                </tr>
            {% endfor %}
        </tbody>
    </table>

    <!-- Sección de Seguimientos -->
    <h2>Seguimientos Recientes</h2>
    {% if seguimientos %}
        <table>
            <thead>
                <tr>
                    <th>Medicamento</th>
                    <th>Fecha Inicio</th>
                    <th>Fecha Final</th>
                    <th>Stock Final</th>
                    <th>Frecuencia (hrs)</th>
                </tr>
            </thead>
            <tbody>
                {% for seguimiento in seguimientos %}
                    <tr>
                        <td>{{ seguimiento.nombre }}</td>
                        <td>{{ seguimiento.fecha_inicio }}</td>
                        <td>{{ seguimiento.fecha_final }}</td>
                        <td>{{ seguimiento.stock_final }}</td>
                        <td>{{ seguimiento.frecuencia }}</td>
                    </tr>
                {% endfor %}
            </tbody>
        </table>
    {% else %}
        <p>No hay seguimientos recientes disponibles.</p>
    {% endif %}

    <!-- Enlace para ver todos los seguimientos -->
    <a href="{{ url_for('seguimientos') }}">Ver Todos los Seguimientos</a>
</body>
</html>
